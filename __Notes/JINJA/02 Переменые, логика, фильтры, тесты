----------------------------------------------------------------------------------------------------------------------
Обращение к переменным атрибута (есть два способа)
----------------------------------------------------------------------------------------------------------------------
{{foo.bar}}
{{foo['bar']}}

----------------------------------------------------------------------------------------------------------------------
ФИЛЬТРЫ (МЕТОДЫ СТРОК)
----------------------------------------------------------------------------------------------------------------------
; В dbt есть ряд фильтров, которые мы можем применять к переменным
; Пишутся через знак |. Можно сколько угодно подряд

; грубо говоря это методы работы со строками (боже, вот зачем придумывать новые термины для уже известных понятий)

{{name|striptags|title}}

title                           - делает первую букву заглавной, остальные прописными
replace('73','9d')              - реплэйс он и в африке реплейс

; все методы: https://jinja.palletsprojects.com/en/stable/templates/#builtin-filters

можно применять фильтр к целому блоку текста

{% filter upper %}
фильтруемый текст
{% endfilter%}

----------------------------------------------------------------------------------------------------------------------
ТЕСТЫ (ФУНКЦИИ ВОЗВРАЩАЮЩИЕ TRUE/FALSE)
----------------------------------------------------------------------------------------------------------------------

{% loop.index is divisibleby 3}         - проверка на деление на 3 без остатка
{% loop.index is divisibleby(3)}

; все тесты https://jinja.palletsprojects.com/en/stable/templates/#builtin-tests

----------------------------------------------------------------------------------------------------------------------
ЭКРАНИРОВАНИЕ
----------------------------------------------------------------------------------------------------------------------
{{ '{{' }}

{% raw %}
пишем любой текст с любыми символами
{% endraw %}

----------------------------------------------------------------------------------------------------------------------
УПРАВЛЯЮЩИЕ КОНСТРУКЦИИ ---- ЦИКЛ FOR
----------------------------------------------------------------------------------------------------------------------
====================================== простая итерация
{% for user in users}
{% endfor}
====================================== итерация пар ключ-значение
{% for key, value in my_dict.items()%}
key={{key}}, value={{value}}
{% endfor}
====================================== сортировка списка перед итерацией (фильтром сортировки)
{% for key, value in my_dict|dictsort%}
key={{key}}, value={{value}}
{% endfor}
; переменная loop содержит метаданные цикла и итерации  https://jinja.palletsprojects.com/en/stable/templates/#for
; - индекс цикла, предыдущее значение цикла, флаг чет/нечет и тп

----------------------------------------------------------------------------------------------------------------------
УПРАВЛЯЮЩИЕ КОНСТРУКЦИИ ---- IF ELSE
----------------------------------------------------------------------------------------------------------------------
{% if execute %}
    {% set important_aircrufts = aircraft_query_result.columns[0].values()%}
{% else%}
    {% set important_aircrufts = []%}
{% endif %}



----------------------------------------------------------------------------------------------------------------------
ПЕРЕМЕННЫЕ И ПРИСВОЕНИЕ ЗНАЧЕНИЙ
----------------------------------------------------------------------------------------------------------------------
====================================== простое присвоение
{%set a = value%}
{%set a, b = call_somethong() %}
====================================== присвоение результата блока
{% set aircraft_query%}  -- присвоется строка с запросом
    SELECT distinct
        aircraft_code
    from
        {{ ref('fct_flight_shedule')}}
{% endset%}



; ====================================================================================================================
; ====================================================================================================================
; ДЛЯ ПЕРЕМЕННХ МОЖНО ИСПОЛЬЗОВАТЬ PYTHON МЕТОДЫ, КОТОРЫЕ ПРЕДНАЗНАЧЕНЫ ДЛЯ ЭТОГО ТИПА ДАННЫХ ИЗ СТАНДАРТНЫХ БИБЛИОТЕК
; ====================================================================================================================
; ====================================================================================================================